"use strict";(self.webpackChunkhalo_documentation=self.webpackChunkhalo_documentation||[]).push([[6722],{8361:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"documentations/adaptor/bootstrapping","title":"Halo Dot Adaptor Bootstrapping Guide","description":"Overview","source":"@site/docs/documentations/adaptor/02 - bootstrapping.md","sourceDirName":"documentations/adaptor","slug":"/documentations/adaptor/bootstrapping","permalink":"/docs/documentations/adaptor/bootstrapping","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"documentationSidebar","previous":{"title":"Halo Dot Adaptor Setup Guide","permalink":"/docs/documentations/adaptor/adaptor"}}');var i=r(74848),o=r(28453);const t={},a="Halo Dot Adaptor Bootstrapping Guide",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Bootstrapping Process",id:"bootstrapping-process",level:2},{value:"Step 1: Add the Halo Dot Helm Repository",id:"step-1-add-the-halo-dot-helm-repository",level:3},{value:"Step 2: Prepare Configuration Files",id:"step-2-prepare-configuration-files",level:3},{value:"config.yaml",id:"configyaml",level:4},{value:"secrets.yaml - Sensitive Configuration",id:"secretsyaml---sensitive-configuration",level:4},{value:"Step 3: Configure Terminal Overrides (Optional)",id:"step-3-configure-terminal-overrides-optional",level:3},{value:"Step 4: Run the Bootstrapper",id:"step-4-run-the-bootstrapper",level:3},{value:"Step 5: Verify Bootstrapping Success",id:"step-5-verify-bootstrapping-success",level:3},{value:"Step 6: Clean Up",id:"step-6-clean-up",level:3},{value:"Configuration Reference",id:"configuration-reference",level:2},{value:"Currency Codes",id:"currency-codes",level:3},{value:"EMV Tags for Encryption",id:"emv-tags-for-encryption",level:3},{value:"Terminal Configuration Overrides",id:"terminal-configuration-overrides",level:3},{value:"Post-Bootstrapping Steps",id:"post-bootstrapping-steps",level:2},{value:"Provide JWT Configuration to Halo Dot",id:"provide-jwt-configuration-to-halo-dot",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Bootstrapper Job Fails",id:"bootstrapper-job-fails",level:3},{value:"Configuration Not Applied",id:"configuration-not-applied",level:3},{value:"JWT Validation Errors",id:"jwt-validation-errors",level:3},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Re-running Bootstrapping",id:"re-running-bootstrapping",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"halo-dot-adaptor-bootstrapping-guide",children:"Halo Dot Adaptor Bootstrapping Guide"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"After deploying the Halo Dot Adaptor, you must bootstrap the installation to initialize the database\nwith required configuration values. The bootstrapping process sets up essential payment processing\nparameters, terminal configurations, and security settings that enable the Adaptor to process\nSoftPOS transactions."}),"\n",(0,i.jsx)(n.p,{children:"This guide walks you through running the Halo Dot bootstrapper, which is provided as a Helm chart\nfor simplified deployment."}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsx)(n.p,{children:"Before bootstrapping, ensure:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Adaptor Deployment Complete"}),": The Halo Dot Adaptor must be successfully deployed and running"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Network Connectivity"}),": The bootstrapper must be able to reach the Adaptor service"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"JWT Public Key Ready"}),": You'll need your JWT public key for SDK authentication"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Helm 3.x"}),": Installed on your local machine"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"bootstrapping-process",children:"Bootstrapping Process"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-add-the-halo-dot-helm-repository",children:"Step 1: Add the Halo Dot Helm Repository"}),"\n",(0,i.jsx)(n.p,{children:"If you haven't already added the repository during Adaptor installation:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm repo add halodot https://halo-dot.github.io/helm-charts\nhelm repo update\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-2-prepare-configuration-files",children:"Step 2: Prepare Configuration Files"}),"\n",(0,i.jsx)(n.p,{children:"The bootstrapper requires the configuration file:"}),"\n",(0,i.jsx)(n.h4,{id:"configyaml",children:"config.yaml"}),"\n",(0,i.jsxs)(n.p,{children:["Create a ",(0,i.jsx)(n.code,{children:"config.yaml"})," file with your configuration:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# Basic bootstrapper configuration\nbootstrap:\n  # Acquirer configuration (your app identity)\n  acquirer:\n    name: "YourCompanyName"\n    alias: "YourCompanyAlias"\n  \n  # Terminal configuration\n  terminalCurrencyCode: "0840"  # USD (ISO 4217)\n  encryptTags: "57,5A"  # Standard EMV tags for encryption\n  \n  # Payment provider configuration\n  paymentProvider:\n    name: "PaymentProvider"\n    url: "http://paymentprovider.halo.svc.cluster.local"\n  \n  # JWT configuration for SDK authentication\n  jwt:\n    issuerName: "softpos-api.yourdomain.com"\n    key: |\n      -----BEGIN PUBLIC KEY-----\n      MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...\n      <your-jwt-public-key>\n      ...\n      -----END PUBLIC KEY-----\n  \n  # Job configuration\n  name: "bootstrap"\n  backoffLimit: 3  # Number of retries before failing\n  \n  image:\n    repository: <provided-repository>\n    tag: <provided-version>\n    pullPolicy: Always\n\n# Adaptor connection configuration\nadaptor:\n  url: "http://adaptor.halo.svc.cluster.local"\n  namespace: "halo"\n  username: "admin"\n\n# Image pull secret configuration (if using private registry)\nimageCredentials:\n  enabled: true\n  registry: "<provided-registry>"\n  username: "<provided-username>"\n  email: "ops@yourcompany.com"\n'})}),"\n",(0,i.jsx)(n.h4,{id:"secretsyaml---sensitive-configuration",children:"secrets.yaml - Sensitive Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Create a ",(0,i.jsx)(n.code,{children:"secrets.yaml"})," file with sensitive values:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# Adaptor admin credentials\nadaptor:\n  currentPassword: "password"  # Default password\n  newPassword: "<strong-password>"  # Set a strong password\n\n# Image registry password\nimageCredentials:\n  password: "<registry-password>"\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Security Best Practice"}),": Encrypt ",(0,i.jsx)(n.code,{children:"secrets.yaml"})," using a tool like\n",(0,i.jsx)(n.a,{href:"https://github.com/getsops/sops",children:"SOPS"})," or ",(0,i.jsx)(n.a,{href:"https://sealed-secrets.netlify.app/",children:"Sealed Secrets"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Example using SOPS with AWS KMS\nsops --encrypt --kms arn:aws:kms:region:account:key/key-id secrets.yaml > secrets.enc.yaml\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-3-configure-terminal-overrides-optional",children:"Step 3: Configure Terminal Overrides (Optional)"}),"\n",(0,i.jsxs)(n.p,{children:["If you need to customize terminal behaviour for specific card applications (AIDs), add the\n",(0,i.jsx)(n.code,{children:"configOverride"})," section:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'bootstrap:\n  configOverride:\n    - aid: "A0000000031010"  # Visa\n      kernelID: 3\n      transactionTypeConfigs:\n        - transactionType: "00"  # Purchase\n          tlvDatabase:\n            - tag: "9F33"  # Terminal Capabilities\n              value: "E0F8C8"\n            - tag: "9F35"  # Terminal Type\n              value: "22"\n    - aid: "A0000000041010"  # Mastercard\n      kernelID: 2\n      transactionTypeConfigs:\n        - transactionType: "00"\n          tlvDatabase:\n            - tag: "9F33"\n              value: "E0F8C8"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-run-the-bootstrapper",children:"Step 4: Run the Bootstrapper"}),"\n",(0,i.jsx)(n.p,{children:"Execute the bootstrapping job:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# If using encrypted secrets\nsops -d secrets.enc.yaml > /tmp/secrets.yaml\nhelm install bootstrapper halodot/halo-adaptor-bootstrapper \\\n  --values config.yaml \\\n  --values /tmp/secrets.yaml \\\n  --namespace halo \\\n  --wait\nrm /tmp/secrets.yaml\n\n# If using plain secrets (not recommended for production)\nhelm install bootstrapper halodot/halo-adaptor-bootstrapper \\\n  --values config.yaml \\\n  --values secrets.yaml \\\n  --namespace halo \\\n  --wait\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-5-verify-bootstrapping-success",children:"Step 5: Verify Bootstrapping Success"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Check job completion"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'kubectl get jobs -n halo\n# Should show bootstrapper job as "Completed"\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Review bootstrapper logs"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl logs -n halo job/bootstrap\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Verify configuration in Adaptor"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Port-forward to Adaptor\nkubectl port-forward -n halo svc/adaptor 8443:443\n\n# In another terminal, check admin access\ncurl -k -u admin:<new-password> https://localhost:8443/api/v1/config\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-6-clean-up",children:"Step 6: Clean Up"}),"\n",(0,i.jsx)(n.p,{children:"Once bootstrapping is successful, remove the bootstrapper:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm uninstall bootstrapper -n halo\n"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration-reference",children:"Configuration Reference"}),"\n",(0,i.jsx)(n.h3,{id:"currency-codes",children:"Currency Codes"}),"\n",(0,i.jsxs)(n.p,{children:["Common ISO 4217 currency codes for ",(0,i.jsx)(n.code,{children:"terminalCurrencyCode"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"| Currency | Code | Numeric | |----------|------|---------| | US Dollar | USD | 0840 | | Euro | EUR\n| 0978 | | British Pound | GBP | 0826 | | South African Rand | ZAR | 0710 | | Australian Dollar |\nAUD | 0036 | | Canadian Dollar | CAD | 0124 |"}),"\n",(0,i.jsx)(n.h3,{id:"emv-tags-for-encryption",children:"EMV Tags for Encryption"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"encryptTags"})," parameter specifies which EMV tags should be encrypted. Common sensitive tags:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"57"})," - Track 2 Equivalent Data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"5A"})," - Primary Account Number (PAN)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"5F20"})," - Cardholder Name"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"5F24"})," - Application Expiration Date"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"terminal-configuration-overrides",children:"Terminal Configuration Overrides"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"configOverride"})," array allows customization per card application (AID):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'configOverride:\n  - aid: "<application-identifier>"\n    kernelID: <kernel-number>\n    transactionTypeConfigs:\n      - transactionType: "<type-code>"\n        tlvDatabase:\n          - tag: "<emv-tag>"\n            value: "<hex-value>"\n'})}),"\n",(0,i.jsx)(n.p,{children:"Common transaction types:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"00"})," - Purchase"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"20"})," - Refund"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"post-bootstrapping-steps",children:"Post-Bootstrapping Steps"}),"\n",(0,i.jsx)(n.h3,{id:"provide-jwt-configuration-to-halo-dot",children:"Provide JWT Configuration to Halo Dot"}),"\n",(0,i.jsx)(n.p,{children:"After successful bootstrapping, provide Halo Dot support with:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"JWT Issuer Name"}),": The value from ",(0,i.jsx)(n.code,{children:"bootstrap.jwt.issuerName"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"JWT Public Key"}),": The key configured in ",(0,i.jsx)(n.code,{children:"bootstrap.jwt.key"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"bootstrapper-job-fails",children:"Bootstrapper Job Fails"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Check logs"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl logs -n halo job/bootstrap\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Common issues"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Connection refused"}),": Verify Adaptor service is running and accessible"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Authentication failed"}),": Check admin credentials in secrets.yaml"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Invalid configuration"}),": Validate YAML syntax and required fields"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"configuration-not-applied",children:"Configuration Not Applied"}),"\n",(0,i.jsx)(n.p,{children:"If configuration doesn't appear to take effect:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Check Adaptor logs"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl logs -n halo -l app=adaptor --tail=100\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Re-run bootstrapper"})," if needed:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm upgrade bootstrapper halodot/halo-adaptor-bootstrapper \\\n  --values config.yaml \\\n  --values secrets.yaml \\\n  --namespace halo\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"jwt-validation-errors",children:"JWT Validation Errors"}),"\n",(0,i.jsx)(n.p,{children:"If SDK authentication fails after bootstrapping:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Verify public key format"}),": Ensure PEM format with proper headers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Check issuer name"}),": Must match exactly what's configured in your SDK"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validate key pair"}),": Ensure public key matches the private key used for signing"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Secrets Management"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Never commit ",(0,i.jsx)(n.code,{children:"secrets.yaml"})," to version control"]}),"\n",(0,i.jsx)(n.li,{children:"Use encryption tools for secrets at rest"}),"\n",(0,i.jsx)(n.li,{children:"Rotate admin password after initial setup"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Network Security"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Bootstrapper only needs internal cluster access"}),"\n",(0,i.jsx)(n.li,{children:"No external network access required"}),"\n",(0,i.jsx)(n.li,{children:"Remove bootstrapper after completion"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"re-running-bootstrapping",children:"Re-running Bootstrapping"}),"\n",(0,i.jsx)(n.p,{children:"The bootstrapper can be run multiple times if you need to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Update terminal configuration"}),"\n",(0,i.jsx)(n.li,{children:"Change payment provider settings"}),"\n",(0,i.jsx)(n.li,{children:"Modify JWT configuration"}),"\n",(0,i.jsx)(n.li,{children:"Reset admin credentials"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"To re-run:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm upgrade --install bootstrapper halodot/halo-adaptor-bootstrapper \\\n  --values config.yaml \\\n  --values secrets.yaml \\\n  --namespace halo \\\n  --wait\n"})}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsx)(n.p,{children:"After successful bootstrapping:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Complete JWT setup"})," with Halo Dot support"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Configure monitoring"})," for the Adaptor"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Set up your SoftPOS applications"})," to connect to the Adaptor"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Perform end-to-end testing"})," with test cards"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Plan for production deployment"})," including security hardening"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"For additional support, contact Halo Dot with:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Bootstrapper logs"}),"\n",(0,i.jsx)(n.li,{children:"Configuration files (sanitized)"}),"\n",(0,i.jsx)(n.li,{children:"Your issuer name"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>a});var s=r(96540);const i={},o=s.createContext(i);function t(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);