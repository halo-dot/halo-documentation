<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-documentations/sdk/sdk-integration-guide" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">SDK Mobile Integration Guide | Halodot.io</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://cdn.prod.website-files.com/63f8ad30f40a41f7b046d567/67ac8d81adc0bbd4b1e9e0dc_Image.png"><meta data-rh="true" name="twitter:image" content="https://cdn.prod.website-files.com/63f8ad30f40a41f7b046d567/67ac8d81adc0bbd4b1e9e0dc_Image.png"><meta data-rh="true" property="og:url" content="http://docs.halodot.io/docs/documentations/sdk/sdk-integration-guide"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="algolia-site-verification" content="EC2FE34B58BA9FB0"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SDK Mobile Integration Guide | Halodot.io"><meta data-rh="true" name="description" content="This README provides technical guidance on the integration of the Halo.SDK with a host Android application.&amp;#x20;"><meta data-rh="true" property="og:description" content="This README provides technical guidance on the integration of the Halo.SDK with a host Android application.&amp;#x20;"><link data-rh="true" rel="icon" href="/img/favicon-32x32.png"><link data-rh="true" rel="canonical" href="http://docs.halodot.io/docs/documentations/sdk/sdk-integration-guide"><link data-rh="true" rel="alternate" href="http://docs.halodot.io/docs/documentations/sdk/sdk-integration-guide" hreflang="en"><link data-rh="true" rel="alternate" href="http://docs.halodot.io/docs/documentations/sdk/sdk-integration-guide" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://S2W3MQE857-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"SDK Integration Guide","item":"http://docs.halodot.io/docs/category/sdk-integration-guide"},{"@type":"ListItem","position":2,"name":"SDK Mobile Integration Guide","item":"http://docs.halodot.io/docs/documentations/sdk/sdk-integration-guide"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Halodot.io RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Halodot.io Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Halodot.io" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.e57b2d57.css">
<script src="/assets/js/runtime~main.e7703113.js" defer="defer"></script>
<script src="/assets/js/main.2ec7bdd6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="https://cdn.prod.website-files.com/63f8ad30f40a41f7b046d567/63fdb37c730d1f0e75df5d44_Logo.svg"><link rel="preload" as="image" href="/img/SDKBoundry.png"><link rel="preload" as="image" href="/img/halodot-backend.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://cdn.prod.website-files.com/63f8ad30f40a41f7b046d567/63fdb37c730d1f0e75df5d44_Logo.svg" alt="halo dot Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://cdn.prod.website-files.com/63f8ad30f40a41f7b046d567/63fdb37c730d1f0e75df5d44_Logo.svg" alt="halo dot Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/intents">Documentation</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/documentations/sdk/sdk-integration-guide">4.0</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/documentations/sdk/sdk-integration-guide">4.0</a></li><li><a class="dropdown__link" href="/docs/versioned_docs/version-2.1/documentations/sdk/sdk-integration-guide">2.1</a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/halo-dot/test_app-android_sdk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/intents">Intents</a><button aria-label="Expand sidebar category &#x27;Intents&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/sdk-integration-guide">SDK Integration Guide</a><button aria-label="Collapse sidebar category &#x27;SDK Integration Guide&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentations/sdk/getting-started-with-sdk">Accessing the SDK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/documentations/sdk/sdk-integration-guide">SDK Mobile Integration Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentations/sdk/halo-system-baseline">Halo System Baseline</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/documentations/sdk/branding-guidelines">Branding Guidelines</a><button aria-label="Expand sidebar category &#x27;Branding Guidelines&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/api-docs">API Docs</a><button aria-label="Expand sidebar category &#x27;API Docs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tap-on-own-device">Tap on own device</a><button aria-label="Expand sidebar category &#x27;Tap on own device&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/documentations/security-guidance">Security guidance</a><button aria-label="Expand sidebar category &#x27;Security guidance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/the-adaptor">The Adaptor</a><button aria-label="Expand sidebar category &#x27;The Adaptor&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/sdk-integration-guide"><span>SDK Integration Guide</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">SDK Mobile Integration Guide</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 4.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>SDK Mobile Integration Guide</h1></header>
<p>This README provides technical guidance on the integration of the Halo.SDK with a host Android application. </p>
<table><thead><tr><th>The Halo Dot SDK is an Isolating MPoC SDK payment processing MPOC Software with Attestation &amp; Monitoring Capabilities.</th></tr></thead><tbody><tr><td><p>The Architecture of this isolating MPoC Payment Software, is described in the diagram below.</p><p></p><p>The below diagram also showcases the SDK boundary and the interaction between the SDK its integrating channels, and the 3rd party payment gateway. It also describes the boundary of the SDK and how it interacts with integrators and the third party payments. It also includes details of how the data is communicated sent in-between the boundary.  </p></td></tr></tbody></table>
<figure><img src="/img/SDKBoundry.png" alt=""><figcaption><p>SDK Boundry</p></figcaption></figure>
<figure><img src="/img/halodot-backend.png" alt=""><figcaption>Halo Backend</figcaption></figure>
<p>The Halo.SDK is an isolated system development kit with A&amp;M functionality. It operates in an isolated memory space, which provides sufficient separation of data processing between the SDK and other software (including the integrating app).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-remote-attestation-of-application-by-halo-server">1. Remote Attestation of Application by Halo Server<a href="#1-remote-attestation-of-application-by-halo-server" class="hash-link" aria-label="Direct link to 1. Remote Attestation of Application by Halo Server" title="Direct link to 1. Remote Attestation of Application by Halo Server">​</a></h2>
<p>In accordance with prescribed security requirements, the Halo server performs remote attestation of the application using the Google Play Integrity attestation framework.</p>
<p><strong>APK Values Required by Halo Server for Remote Attestation</strong></p>
<p>The following attestation payload field must be configured in the Halo server with each release so that they can be checked by the server during remote attestation.</p>
<table><thead><tr><th>field</th><th>description</th></tr></thead><tbody><tr><td>apkPackageName</td><td>fully qualified APK name, e.g. za.co.synthesis.halo.halo_mpos_new</td></tr><tr><td>apkCertificateDigestSha256</td><td>base64 encoded, SHA-256 hash of the certifi cate used to sign requesting app</td></tr><tr><td>applicationVersion</td><td>version number of application of host application</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-requirements-on-the-mobile-back-end">2. Requirements on the Mobile Back-End<a href="#2-requirements-on-the-mobile-back-end" class="hash-link" aria-label="Direct link to 2. Requirements on the Mobile Back-End" title="Direct link to 2. Requirements on the Mobile Back-End">​</a></h2>
<p><strong>JWT</strong></p>
<p>All calls were made to the Halo.SDK requires a valid JWT. The mobile application server is expected to supply the mobile app with a JWT that can be used to authenticate with the Halo Kernel Server. The SDK requires a callback function, <code>onRequestJWT(callback: (String) -&gt; Unit)</code>, that it will use whenever a JWT is required.</p>
<p>An asymmetric key is used so that the JWT can be issued (signed) by one system (mobile application server), and independently verified by another (Halo server).</p>
<p><strong>JWT LifeTime</strong></p>
<p>Since the JWT essentially authorizes payment acceptance for a given merchant user, it is essential that the JWT lifetime be kept as short as possible, in order to limit the amount of time an attacker has to crack the key itself and then to limit the scope of damage in the event of a key compromise.</p>
<p>A lifetime of 15 minutes is recommended.</p>
<p><strong>JWT Signing Public Key Format</strong></p>
<p>The JWT public key should be published as a certificate, in a text-friendly format, e.g. B64 encoded PEM (.crt, .pem).</p>
<p><strong>JWT Serialization Format</strong></p>
<p>The compact serialization format is expected, i.e:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">urlencodedB64(header) + &#x27;.&#x27; + urlencodedB64(payload) + &#x27;.&#x27; + urlencodedB64(signature)</span><br></span></code></pre></div></div>
<p>For example:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2dnZWRJbkFzIjoiYWRtaW4iLCJpYXQiOjE0MjI3Nzk2Mzh9.gzSraSYS8EXBxLN_oWnFSRgCzcmJmMjLiuyu5CSpyH</span><br></span></code></pre></div></div>
<p><strong>JWT Claims</strong></p>
<p>The JWT must make a number of claims - all of them standard except for aud_fingerprints (Audience Fingerprints):</p>
<table><thead><tr><th style="text-align:center">field</th><th style="text-align:center">type</th><th>Note</th></tr></thead><tbody><tr><td style="text-align:center">alg</td><td style="text-align:center">String</td><td>The signing algorithm is RSA signed SHA-256 hash, aliased as RS256. An asymmetric encryption(signing) scheme is required to allow the Kernel Server to be able to validate the token without being able to generate it. If symmetric key encryption was used to sign the auth token (e.g., using the HMAC algorithm), then non-repudiation would be lost.</td></tr><tr><td style="text-align:center">sub</td><td style="text-align:center">String</td><td>The Payment Processor Merchant-User ID, or Application ID</td></tr><tr><td style="text-align:center">iss</td><td style="text-align:center">String</td><td>This is a unique (from the perspective of Halo server) identifier for the JWT issuer, agreed upon by the JWT issuer and Synthesis, and configured in advance by Synthesis in the Halo server, e.g. authserver.haloplus.io</td></tr><tr><td style="text-align:center">aud</td><td style="text-align:center">String</td><td>URL of Halo server TLS endpoint, e.g. &#x27;kernelserver.qa.haloplus.io&#x27;. This value should be obtained from Synthesis (different per environment) e.g. for QA it would be &#x27;kernelserver.qa.haloplus.io&#x27; and for DEV &#x27;kernelserver.za.dev.haloplus.io&#x27;</td></tr><tr><td style="text-align:center">usr</td><td style="text-align:center">String</td><td>The details of the user performing the transaction, typically the username used to sign into the Integrators application.</td></tr><tr><td style="text-align:center">iat</td><td style="text-align:center">NumericDate</td><td>The UTC timestamp of when the JWT was generated.</td></tr><tr><td style="text-align:center">exp</td><td style="text-align:center">NumericDate</td><td>The UTC time of expiration of the JWT.</td></tr><tr><td style="text-align:center">aud_fingerprints</td><td style="text-align:center">String</td><td>a CSV list of expected SHA-256 fingerprints for the Kernel Server TLS endpoint. This list may contain multiple values to support certificate rotation. In the QA environment, the expected value as of writting this would be: &quot;sha256/zc6c97JhKPZUa+rIrVqjknDE1lDcDK77G41sDo+1ay0=&quot;</td></tr></tbody></table>
<p><strong>If using the Halo Dot Adaptor, the following additional fields are required</strong></p>
<p>These are only supported from SDK version 4.0.2.</p>
<table><thead><tr><th style="text-align:center">field</th><th style="text-align:center">type</th><th>Note</th></tr></thead><tbody><tr><td style="text-align:center">x-am-endpoint</td><td style="text-align:center">String</td><td>URL of Halo A&amp;M endpoint, e.g. &#x27;kernelserver.qa.haloplus.io&#x27;.</td></tr><tr><td style="text-align:center">x-am-endpoint-fingerprints</td><td style="text-align:center">String</td><td>a CSV list of expected SHA-256 fingerprints for the A&amp;M endpoint. This list may contain multiple values to support certificate rotation. In the QA environment, the expected value as of writting this would be: &quot;sha256/zc6c97JhKPZUa+rIrVqjknDE1lDcDK77G41sDo+1ay0=&quot;</td></tr></tbody></table>
<p>All these values can be validated by making a POST request to &quot;<a href="https://kernelserver.qa.haloplus.io/tokens/checkjwt" target="_blank" rel="noopener noreferrer">https://kernelserver.qa.haloplus.io/tokens/checkjwt</a>&quot;. Your JWT should be added as header (Bearer Auth).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-sdk-binary">3. SDK Binary<a href="#3-sdk-binary" class="hash-link" aria-label="Direct link to 3. SDK Binary" title="Direct link to 3. SDK Binary">​</a></h2>
<p>HaloSDK is written in Kotlin and packaged as an AAR (Android Archive Library). For security reasons, the compiled binary has been obfuscated.</p>
<p>See the <a href="/docs/documentations/sdk/getting-started-with-sdk">Getting Started Guide</a> for a detailed guide on accessing and getting started with the SDK.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-application-manifest">4. Application Manifest<a href="#4-application-manifest" class="hash-link" aria-label="Direct link to 4. Application Manifest" title="Direct link to 4. Application Manifest">​</a></h2>
<p>The <code>AndroidManifest.xml</code> application manifest file of the mobile application must include the following user permissions:</p>
<ul>
<li><code>android.permission.INTERNET</code> - call out to the backend over the internet</li>
<li><code>android.permission.NFC</code>- use the NFC module</li>
<li><code>android.permission.BLUETOOTH_SCAN</code> - Bluetooth scan permissions*</li>
<li><code>android.permission.BLUETOOTH_CONNECT</code> - Bluetooth connect permissions*</li>
</ul>
<p>In addition, in order to indicate to the Play store that this is an NFC-enabled app, the <code>android.hardware.nfc</code> the feature needs to be specifi ed, with <code>required=false</code> . If required is set to true then the mobile app itself will not be allowed to be installed on devices that don&#x27;t support NFC, which is presumed to not be the desired behavior.</p>
<p>* Permissions required for the MPOC certfication and are used to detect any malicious devices.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-life-cycle-methods">5. Life-Cycle Methods<a href="#5-life-cycle-methods" class="hash-link" aria-label="Direct link to 5. Life-Cycle Methods" title="Direct link to 5. Life-Cycle Methods">​</a></h2>
<p>In order for the SDK to properly handle the Android application life cycle, the host app needs to add hooks into the following Android lifecycle methods on the <code>MAIN activity</code>.</p>
<p>⚠️<!-- --> <strong>do not hook up to a SUB activity or a fragment</strong> as this will cause problems</p>
<p>List of Android lifecycle methods:</p>
<ul>
<li><code>onCreate(Bundle savedInstanceState)</code></li>
<li><code>onStart()</code></li>
<li><code>onResume()</code></li>
<li><code>onPause()</code></li>
<li><code>onStop()</code></li>
<li><code>onSaveInstanceState(Bundle outState, PersistableBundle outPersistentState)</code></li>
<li><code>onSaveInstanceState(Bundle outState)</code></li>
<li><code>onDestroy()</code></li>
</ul>
<p>Halo.SDK has corresponding static methods with matching method signatures for each of the Android lifecycle methods.</p>
<p>This can all be wired up as follows:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class MainActivity extends AppCompatActivity {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void onCreate(Bundle savedInstanceState, PersistableBundle persistentState) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.onCreate(savedInstanceState, persistentState);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // your mobile app code here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HaloSDK.onCreate(this , this, savedInstanceState, persistentState);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected void onStart() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.onStart();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // your mobile app code here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HaloSDK.onStart();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected void onResume() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.onResume();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // your mobile app code here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HaloSDK.onResume();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected void onPause() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.onPause();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // your mobile app code here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HaloSDK.onPause();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected void onStop() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.onStop();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // your mobile app code here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HaloSDK.onStop();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void onSaveInstanceState(@NonNull Bundle outState, @NonNull PersistableBundle outPersistentState) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.onSaveInstanceState(outState, outPersistentState);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // your mobile app code here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HaloSDK.onSaveInstanceState(outState, outPersistentState);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected void onSaveInstanceState(@NonNull Bundle outState) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.onSaveInstanceState(outState);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // your mobile app code here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HaloSDK.onSaveInstanceState(outState);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected void onDestroy() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.onDestroy();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // your mobile app code here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HaloSDK.onDestroy();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-initialization-of-the-sdk">6. Initialization of the SDK<a href="#6-initialization-of-the-sdk" class="hash-link" aria-label="Direct link to 6. Initialization of the SDK" title="Direct link to 6. Initialization of the SDK">​</a></h2>
<p>Separate from the lifecycle hooks, the SDK must be initialized before transacting by calling the static <code>initialize</code> method on the SDK, passing it a <code>HaloInitializationParameters</code> object.</p>
<p>The SDK will attempt to perform the following sequence of actions:</p>
<ul>
<li>the Perform runtime checks (the device is not rooted, running in debug mode, or under instrumentation)</li>
<li>Confirm that the software (Android version) and hardware platform (NFC device) is sufficient</li>
<li>Connect to the server, passing on the JWT for verification</li>
<li>Confirm that the device has been enrolled, and is not blocked - re-enrolling if necessary</li>
<li>Perform device-local Google Play Integrity key attestation actions, and submit results to the server for remote verification</li>
<li>Retrieve terminal configuration from the server</li>
<li>Initialize the SDK to a state where it will accept transactions</li>
</ul>
<p>The result will be communicated, typically asynchronously (depending on exactly what happens and when), to the host application via invoking the callback registered in <code>IHaloCallbacks.onInitializationResult</code> and passing a <code>HaloInitializationResult</code>.</p>
<p>The <code>HaloInitializationResult.resultType</code> field indicates whether or not the initialization was successful or not. A value <code>Initialized</code> indicates success, all other values indicate some kind of failure.</p>
<p>In the case of failure, the <code>errorCode</code> field may hold more information, whereas in the case of success, the SDK is now ready to accept a transaction.</p>
<p><strong>HaloInitializationParameters</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import za.co.synthesis.halo.sdk.model.HaloInitializationParameters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class HaloInitializationParameters {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public IHaloCallbacks haloCallBacks;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Long cardTimeTimeoutMS;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String applicationName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String applicationVersion;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><code>Long cardTimeTimeoutMS</code> - Timeout value, in milliseconds, that the SDK will wait for a card tap after startTransaction has been called, before returning with a timeout error.</p>
<p><code>String applicationName</code> - The fully qualified package name of the calling application.</p>
<p><code>String applicationVersion</code> - The version number of the calling application.</p>
<p><code>IHaloCallbacks haloCallBacks</code> - See below discussion on the <code>IHaloCallbacks</code> interface.</p>
<p><strong>IHaloCallbacks</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import za.co.synthesis.halo.sdk.model.IHaloCallbacks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface IHaloCallbacks {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void onInitializationResult(HaloInitializationResult result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void onHaloUIMessage(HaloUIMessage message);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void onHaloTransactionResult(HaloTransactionResult result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void onRequestJWT(Function1&lt;? super String, Unit&gt; function1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void onAttestationError(HaloAttesationHealthResult result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void onCameraControlLost();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>The <code>IHaloCallbacks</code> interface encapsulates the call-back methods that the HaloSDK will use to asynchronously communicate back to the host application at relevant junctures:</p>
<ol>
<li>The outcome of the initialization process (<code>onInitializationResult</code>)</li>
<li>Interim transaction progress (<code>onHaloUIMessage</code>)</li>
<li>Final outcome of a transaction (<code>onHaloTransactionResult</code>)</li>
<li>Issues with intermittent attestation checks (<code>onAttestationError</code>)</li>
</ol>
<p><strong>HaloInitializationResult</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import za.co.synthesis.halo.sdk.model.HaloInitializationResult</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class HaloInitializationResult {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public HaloInitializationResultType resultType;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Currency terminalCurrency;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public List&lt;String&gt; terminalLanguageCodes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String terminalCountryCode;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String message;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes on <code>HaloInitializationResult</code>:</p>
<ol>
<li>
<p><code>HaloInitializationResultType</code></p>
<p>Here is a list of possible values for <code>HaloInitializationResultType</code></p>
<table><thead><tr><th>Value</th><th>Meaning</th></tr></thead><tbody><tr><td>AuthenticationError</td><td>Error occurred during authentication</td></tr><tr><td>AttestationFailure</td><td>Attestation failed</td></tr><tr><td>AttestationSystemNotInitialised</td><td>Initialisation failed because attestation system is not initialised</td></tr><tr><td>CameraPermissionNotGranted</td><td>No camera permission</td></tr><tr><td>ConfigFetchError</td><td>Unable to fetch terminal config</td></tr><tr><td>DebuggedDevice</td><td>Debug mode detected</td></tr><tr><td>GeneralError</td><td>General failure</td></tr><tr><td>HttpClientError</td><td>Unable to open web connection</td></tr><tr><td>Initialized</td><td>Success</td></tr><tr><td>InitializedWithoutConfigs</td><td>Success status (without using terminal configs)</td></tr><tr><td>InstrumentedDevice</td><td>Runtime instrumentation detected</td></tr><tr><td>NetworkError</td><td>Network socket error during connection to server</td></tr><tr><td>NFCDisabledError</td><td>NFC either absent, turned off, or NFC permission not granted</td></tr><tr><td>NoAppContext</td><td>Appcontext is null - did you call onCreate()?</td></tr><tr><td>NoTerminalContainer</td><td>TerminalContainer is null - did you call onCreate()?</td></tr><tr><td>RemoteAttestationFailure</td><td>Device failed remote leg of Android Play Integrity attestation</td></tr><tr><td>RootedDevice</td><td>Device rooting detected</td></tr><tr><td>TEEAttestationFailure</td><td>Tee attestation failed</td></tr><tr><td>UnableToConfigureTerminal</td><td>Error occurred configuring terminal</td></tr><tr><td>UnsupportedDevice</td><td>The current device is unsupported - usually due to NFC</td></tr><tr><td>UnsupportedOperatingSystemVersion</td><td>Android OS too low</td></tr></tbody></table>
</li>
<li>
<p>Terminal Localisation Information Returned in <code>HaloInitializationResult</code></p>
<p>As part of initialization, the SDK will fetch its pre-defined terminal configuration from the Halo server - and this includes localization data which should be checked by the host application to ensure that the terminal is transacting in the expected currency, which is required for the limit checks done as part of kernel processing to be performed in the correct matching currency. In addition, these values should be used to determine the correct currency symbol and a number of decimal points to use when displaying the transaction amount to the cardholder.</p>
</li>
<li>
<p><code>terminalLanguageCodes</code></p>
<p>The EMV terminal specification dictates that the terminal be configured with a list of language preferences (ISO 639-1 alpha2 language code), ordered from highest to lowest priority. The mobile app should ideally use this list to determine which language to use for display purposes.</p>
</li>
<li>
<p><code>terminalCurrency</code></p>
<p>The terminal has a single supported currency. This is the currency in which card risk limits are configured, and the transaction must be conducted. It is also the currency that must be used when displaying amounts. The mobile app should determine the correct currency symbol and a number of decimal places from this. If this value is not as expected, then the mobile app should not allow transactions.</p>
</li>
<li>
<p><code>terminalCountryCode</code></p>
<p>The terminal is configured with a country code that indicates the domestic country. The returned value is formatted as an ISO 3166-1 numeric 3 country code left padded with zeros to length 4, e.g. 0710 = South Africa.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-transaction-flow">7. Transaction Flow<a href="#7-transaction-flow" class="hash-link" aria-label="Direct link to 7. Transaction Flow" title="Direct link to 7. Transaction Flow">​</a></h2>
<p>This section describes the Transaction flow of the SDK in more detail.</p>
<p><strong>HaloSDK.startTransaction</strong></p>
<p>Once the SDK has been successfully initialized, as indicated by a <code>HaloInitializationResultType</code> of <code>Success</code>, a transaction may be initiated by calling <code>HaloSDK.startTransaction</code>.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public final fun startTransaction(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transactionAmount: java.math.BigDecimal,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    merchantTransactionReference: kotlin.String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): za.co.synthesis.halo.sdk.model.HaloStartTransactionResult</span><br></span></code></pre></div></div>
<p>Let&#x27;s take a closer look at <code>startTransaction</code> parameters:</p>
<ul>
<li><code>transactionAmount</code> - The purchase amount, stated in the <code>terminalCurrency</code> as returned in <code>HaloInitializationResult.terminalCurrency</code>.</li>
<li><code>merchantTransactionReference</code> - It is recommended to use a random GUID for this purpose.</li>
</ul>
<p>The <code>merchantTransactionReference</code> is a unique-per-merchant transaction reference generated and supplied by the mobile application. Halo will generate and maintain its own internal ID for the transaction (<code>haloTransactionReference</code>), but from the perspective of the mobile application <code>merchantTransactionReference</code> together with the value <code>Payment Processor Merchant-User ID</code> specified in the JWT <code>sub</code> field can be used to uniquely identify a merchant transaction.</p>
<p>This value needs to be unique per merchant transaction, i.e. different merchants could use the same <code>merchantTransactionReference</code> for two different transactions, but the value would need to be unique per transaction for a given merchant. In the event that the same <code>merchantTransactionReference</code> is supplied for two different transactions for the same merchant, the second transaction will be rejected by the Halo server, and the final transaction result type returned for the second transaction will be <code>HaloTransactionResultType.DuplicateMerchantTransactionReferenceSupplied</code>.</p>
<p>In the event of the final transaction result type being <code>HaloTransactionResultType.Indeterminate</code> , then it is the <code>merchantTransactionReference</code> that should be used to look up and potentially resolve the final transaction outcome - potentially through a manual reversal by the merchant via the web portal.</p>
<p>The return type of <code>startTransaction</code> is <code>HaloStartTransactionResult</code> and is defined as:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import za.co.synthesis.halo.sdk.model.HaloTransactionResult</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class HaloStartTransactionResult {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public HaloStartTransactionResultType resultType;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public String message;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre></div></div>
<p>where <code>HaloStartTransactionResultType</code> is:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import za.co.synthesis.halo.sdk.model.HaloTransactionResultType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public enum HaloStartTransactionResultType {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Started,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        NotInitialized,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GeneralError,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        NFCDisabledError;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre></div></div>
<p><strong>Start Transaction Flow</strong></p>
<p>As part of starting a transaction, the SDK will check:</p>
<ul>
<li>NFC is present and turned on</li>
<li>SDK itself has been successfully initialized</li>
<li>Platform runtime (root/debug/instrumentation)</li>
</ul>
<p><code>HaloSDK.startTransaction</code> will always synchronously return a <code>HaloStartTransactionResultType</code>, only a value of <code>Started</code> indicates that the SDK is satisfied to actually start a new transaction, all other values indicate a failure of some kind.</p>
<p>In the event of a failure, the return of the <code>startTransaction</code> method signals the end of the transaction and Halo.SDK will invoke no further callbacks, and this outcome should be regarded as the final outcome of this transaction, and full control returns to the mobile application.</p>
<p>If the SDK is able to start the transaction, <code>startTransaction</code> will return a <code>HaloStartTransactionResultType</code> of <code>Started</code>.</p>
<p>From this point onwards, Halo.SDK will communicate interim transaction progress back to the mobile application by means of invoking the <code>IHaloCallback.onHaloUIMessage</code>callback function, and the final transaction outcome by invoking the <code>IHaloCallback.onHaloTransactionResult</code>.</p>
<p><strong>Informing the Merchant of a Tamper Event</strong></p>
<p>If <code>HaloSDK.startTransaction</code> returns a result type of <code>RootedDevice</code>, <code>InstrumentedDevice</code> or <code>DebuggedDevice</code>, then the EMV specification dictates that it is mandatory for the host application to immediately inform the merchant on screen that their device has been tampered with.</p>
<p><strong>Communication of Interim Status</strong></p>
<p>Before the final transaction outcome is communicated via <code>IHaloCallbacks.onHaloTransactionResult</code>, interim transaction progress will typically be communicated to the mobile app via invoking <code>IHaloCallbacks.onHaloUIMessage</code>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">void onHaloUIMessage(HaloUIMessage message);</span><br></span></code></pre></div></div>
<p>It is expected that the mobile app will use these message events as triggers for communicating interim transaction status information or action prompts such as present card, remove card, present card again to the card holder.</p>
<p>Let&#x27;s have a closer look at <code>HaloUIMessage</code>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import za.co.synthesis.halo.sdk.model.HaloUIMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class HaloUIMessage {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public HaloUIMessageID msgID;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int holdTimeMS;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public List&lt;String&gt; languagePreference;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public HaloCurrencyValue offlineBalance;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public HaloCurrencyValue transactionAmount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>And the parameters of <code>HaloUIMessage</code>:</p>
<ol>
<li>
<p><code>HaloUIMessageID msgID</code></p>
<p>The <code>msgID</code> field indicates the interim transaction status, which should be communicated to the user. The following are the types that <code>msgID</code> can be:</p>
<table><thead><tr><th>Enum</th><th>Text</th><th>Description</th></tr></thead><tbody><tr><td>PresentCard</td><td>Present Card</td><td>Initial message, accompanied by transaction amount</td></tr><tr><td>Processing</td><td>Processing...</td><td>May occur between <code>PresentCard</code> and <code>CardReadOK_RemoveCard</code></td></tr><tr><td>CardReadOK_RemoveCard</td><td>Card Read OK, Remove Card</td><td>Card reading has been completed and user should remove card</td></tr><tr><td>SeePhoneForInstructions_ThenTapAgain</td><td>See Phone for Instructions, then Tap Again</td><td>Authorise transaction on payment device, then tap again</td></tr><tr><td>AuthorisingWait</td><td>Authorising, Please Wait...</td><td>Attempting online authorization</td></tr><tr><td>TryAgain</td><td>Try Again</td><td>Initial card read failed, cardholder to present card again - transaction still in progress</td></tr><tr><td>TryAnotherCard</td><td>Try Another Card</td><td>Transaction failed, start a new transaction with a different card</td></tr></tbody></table>
</li>
<li>
<p><code>int holdTimeMS</code></p>
<p>The EMV terminal specification dictates that when multiple messages are received in quick succession for the same transaction, each message must be displayed for a minimum amount of time (the message hold time), before proceeeding to display the next message. This is intended to allow the user enough time to read eachmessage, and typically results in queue-based implementations.</p>
<p>holdTimeMS refl ect the message hold time, in units of milliseconds.</p>
</li>
<li>
<p><code>List languagePreference</code> The EMV specification dictates that cards may include a list of language preferences. If the card does contain such a list, it will be specified in <code>HaloUIMessage</code> as <code>languagePreference</code>, which is a list of ISO 639-1 alpha2 language codes, in order of language.</p>
<p>The mobile application can then choose to display the UI message texts in a preferred language, or if not specifi ed, in its default language.</p>
</li>
</ol>
<p><strong>IHaloCallbacks.onHaloTransactionResult</strong></p>
<p>Once it has completed processing, Halo.SDK communicates the final transaction outcome to the mobile application via invoking the <code>IHaloCallbacks.onHaloTransactionResult</code> callback, and passing it a <code>HaloTransactionResult</code> object. Once the mobile application receives a <code>HaloTransactionResult</code>, it can regard the transaction as concluded, and assume full control again.</p>
<p>Here is a closer look at <code>HaloTransactionResult</code>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class HaloTransactionResult {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public HaloTransactionResultType resultType;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String merchantTransactionReference;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String haloTransactionReference;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String paymentProviderReference;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String message;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public HaloTransactionReceipt receipt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Map&lt;String, String&gt; customTags;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>And the parameters of <code>HaloTransactionResult</code>:</p>
<ol>
<li>
<p><code>HaloTransactionResultType resultType</code></p>
<p>The <code>HaloTransactionResultType resultType</code> field indicates the final transaction status to the host application.</p>
<table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>Approved</td><td>Transaction successfully approved online</td></tr><tr><td>Declined</td><td>Transaction declined, either offl ine by terminal or card, or onliny by issuer</td></tr><tr><td>CardTapTimeOutExpired</td><td>Timed out waiting for a card tap</td></tr><tr><td>NetworkError</td><td>Network socket communication error</td></tr><tr><td>ProcessingError</td><td>An error occurred during EMV card processing</td></tr><tr><td>Cancelled</td><td>Transaction called by host application</td></tr><tr><td>TryAnotherCard</td><td>Transaction failed with this card, but may succeeed with another card</td></tr><tr><td>NFCDisabledError</td><td>NFC on the device is turned off</td></tr><tr><td>NotAuthenticated</td><td>Invalid JWT token provided</td></tr><tr><td>Indeterminate</td><td>Unknown transaction status, inform merchant to manually query transaction status via merchant portal before giving goods</td></tr><tr><td>DuplicateMerchantTransactionReferenceSupplied</td><td>Transaction rejected by server due to use of duplicate merchant transaction reference. attempt again with a new reference</td></tr><tr><td>HealthError</td><td>An error occurred while checking the status of the Kernel Server</td></tr><tr><td>InvalidJWT</td><td>An error occurred while parsing the JWT</td></tr></tbody></table>
<p>Only if a <code>HaloTransactionResultType</code> of <code>Approved</code> is received should the merchant be instructed that the transaction has been successful. If a result of type <code>Indeterminate</code> is returned, then the merchant <strong>MUST</strong> be instructed to query the Payment Processor as to the final transaction outcome - <strong>BEFORE</strong> giving goods/services. This will typically be done either through the host application itself, or via the payment processor&#x27;s merchant management portal. All other values should be regarded as conclusively indicating that the transaction has failed.</p>
</li>
<li>
<p>Transaction References</p>
<table><thead><tr><th>Reference</th><th>Source</th></tr></thead><tbody><tr><td>merchantTransactionReference</td><td><code>HaloSDK.startTransaction.merchantTransactionReference</code></td></tr><tr><td>haloTransactionReference</td><td>Halo server</td></tr><tr><td>paymentProviderReference</td><td>Payment Provider</td></tr></tbody></table>
</li>
<li>
<p>HaloTransactionReceipt</p>
<p>EMV receipt information is specified in <code>HaloTransactionResult.receipt</code>. Approved transactions will always contain receipt information, whereas this is not guaranteed in the case of declined transactions.</p>
<table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>transactionDate</td><td>Transaction Date, YYMMDD</td></tr><tr><td>transactionTime</td><td>Transaction Time, HHMMSS</td></tr><tr><td>aid</td><td>Application ID, 16 hex chars</td></tr><tr><td>applicationLabel</td><td>Application Label, 16 chars</td></tr><tr><td>applicationPreferredName</td><td>Application Preferred Name, 16 chars</td></tr><tr><td>tvr</td><td>Terminal Verification Results, 10 hex chars</td></tr><tr><td>cvr</td><td>Card Verification Results, hex</td></tr><tr><td>cryptogramType</td><td>Application Cryptogram type: AAC, TC, ARQC</td></tr><tr><td>cryptogram</td><td>Application Cryptogram, 16 hex chars</td></tr><tr><td>maskedPAN</td><td>Card PAN masked according to PCI, 16 chars</td></tr><tr><td>authorizationCode</td><td>The final authorization code returned by the issuer in the online response, 12 chars</td></tr><tr><td>ISOResponseCode</td><td>Authorisation Response Code returned by the issuer in the online response</td></tr><tr><td>association</td><td>Card scheme: MasterCard, Visa, AMEX</td></tr><tr><td>expiryDate</td><td>Card application expiry date</td></tr></tbody></table>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-sdk-async-behaviour-after-starttransaction-returns">8. SDK Async Behaviour after startTransaction Returns<a href="#8-sdk-async-behaviour-after-starttransaction-returns" class="hash-link" aria-label="Direct link to 8. SDK Async Behaviour after startTransaction Returns" title="Direct link to 8. SDK Async Behaviour after startTransaction Returns">​</a></h2>
<p>Assuming that <code>startTransaction</code> returns a synchronous result type of <code>Started</code> , the SDK will continue with async transaction processing.</p>
<p><strong>Pre-Processing</strong></p>
<p>The SDK will first perform transaction pre-processing as per the EMV specification. The transaction can be declined during pre-processing (typically due to terminal limits). In this case, the SDK will communicate this by calling <code>IHaloCallbacks.onHaloTransactionResult</code> with <code>HaloTransactionResult.resultType</code> as <code>Declined</code>, then terminate, sending no UI messages.</p>
<p><strong>Enablement of NFC Field</strong></p>
<p>Assuming that pre-processing succeeds, the SDK will attempt to turn the NFC field on. If it is not able to do so (typically because NFC has not been enabled within phone settings), then the SDK will abandon the transaction, and return <code>HaloTransactionResult.resultType</code> as <code>NFCDisabledError</code>.</p>
<p><strong>Confirmation of Transaction Amount</strong></p>
<p>Assuming that the NFC field could be enabled, the SDK will then send a <code>PresentCard</code> <code>HaloUIMessageID</code>, with the transaction amount specified in the <code>transactionAmount</code> field. No action is required by the user to confirm the amount, the message is displayed only for information purposes.</p>
<p><strong>Wait for Tap or Timeout</strong></p>
<p>At this point, the SDK will wait for either a tag to be tapped, or for the card tap timeout to expire. If the timeout occurs, then the SDK will abandon the transaction,and return <code>HaloTransactionResult.resultType</code> as <code>CardTapTimeOutExpired</code>.</p>
<p><strong>On Tap</strong></p>
<p>Assuming the card is tapped in time, the SDK will engage with the card. At this point, 1 of 2 things can happen:</p>
<ol>
<li>A processing error occurs during the card interaction. <code>HaloTransactionResult.resultType</code> of <code>ProcessingError</code> is returned, and the SDK abandons transaction.</li>
<li>The card interaction completes successfully. In this case, the SDK will send a <code>CardReadOK_RemoveCard</code> UI message, and continue with async transaction processing.</li>
</ol>
<p><strong>Potential for Offline Decline</strong></p>
<p>Under some situations, the attempted online transaction may be declined offline by the card, in this case, the SDK will return a <code>HaloTransactionResult.resultType</code> of <code>Declined</code>, and abandon the transaction.</p>
<p><strong>PIN</strong></p>
<p>If the transaction amount exceeds the CVM limit and the card supports online PIN, the SDK will request a PIN for the transaction. This is handled transparently by the SDK using a Trusted User Interface, which will briefly assume control of the mobile device screen to capture a PIN.</p>
<p>Once the PIN has been captured, control will return to the calling application.</p>
<p><strong>Online Processing</strong></p>
<p>Assuming that the card interaction was successful, no processing errors were encountered, and that the card did not decline the transaction outright, then the SDK will attempt to prepare, submit and process an online transaction authorization request.</p>
<p>The SDK will send a <code>OnlineProcessing</code> UI message to indicate that is begun online processing.</p>
<p><strong>General Error During Online Processing</strong></p>
<p>If there is a general error during the preparation of the online request, the SDK will return a <code>HaloTransactionResult.resultType</code> of <code>ProcessingError</code>, and abandon the transaction.</p>
<p><strong>Could Not go Online</strong></p>
<p>If the SDK is unable to submit the online authorization request due to network connectivity issues, it will return a <code>HaloTransactionResult.resultType</code> of <code>NetworkError</code>, and abandon the transaction.</p>
<p><strong>Ambiguous Transaction Outcome</strong></p>
<p>In the event that the SDK was able to connect and submit an online authorization request, but did not receive a response, it will return a <code>HaloTransactionResult.resultType</code> of <code>Indeterminate</code>, and abandon the transaction.</p>
<p>In this case, the user must be instructed to consult the transaction back-end in order to determine the final transaction outcome before handing over the goods/services.</p>
<p><strong>Final Transaction Outcome</strong></p>
<p>Once the SDK has received and processed the online response, it will communicate the fi nal transaction outcome, which at this point should be one of <code>Approved</code>, <code>Declined</code> or <code>NotAuthenticated</code>. A result of <code>NotAuthenticated</code> typically means that the JWT supplied has expired, and that the transaction should be restarted with a fresh JWT. The SDK will then terminate.</p>
<p><strong>Try Another Card</strong></p>
<p>In some cases the SDK will determine that the transaction cannot be completed with the current card/device, in this case it will return a <code>TryAnotherCard</code> result, and the mobile app should instruct the user to attempt the transaction with a different card. From the perspective of the SDK, this will be a new transaction.</p>
<p><strong>Try Again Flow</strong></p>
<p>In some unusual cases, the SDK will require the user to present the same card/device again, in order to complete the transaction. In these cases, the SDK will retain control, but will require the mobile application to communicate instructions to the user via ui messages during the transaction. These instructions will either be to tap the same card/device again ( <code>TryAgain</code> ), or to first consult their device for instructions, then tap the device again ( <code>SeePhoneForInstructions_ThenTapAgain</code> ). It is only when the transaction has been finally concluded that the SDK will communicate a final transaction result as per normal, then terminate.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-conclusion">9. Conclusion<a href="#9-conclusion" class="hash-link" aria-label="Direct link to 9. Conclusion" title="Direct link to 9. Conclusion">​</a></h2>
<p>That concludes the guide to integrate the Halo.SDK into your application. For any questions, please do not hesitate to reach out to the Halo Dot Team.</p>
<p>Not what you were looking for? If you are looking for the Intent Integration guide, it is over <a href="/docs/documentations/sdk/halo-system-baseline">here</a></p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/documentations/sdk/getting-started-with-sdk"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Accessing the SDK</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/documentations/sdk/halo-system-baseline"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Halo System Baseline</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-remote-attestation-of-application-by-halo-server" class="table-of-contents__link toc-highlight">1. Remote Attestation of Application by Halo Server</a></li><li><a href="#2-requirements-on-the-mobile-back-end" class="table-of-contents__link toc-highlight">2. Requirements on the Mobile Back-End</a></li><li><a href="#3-sdk-binary" class="table-of-contents__link toc-highlight">3. SDK Binary</a></li><li><a href="#4-application-manifest" class="table-of-contents__link toc-highlight">4. Application Manifest</a></li><li><a href="#5-life-cycle-methods" class="table-of-contents__link toc-highlight">5. Life-Cycle Methods</a></li><li><a href="#6-initialization-of-the-sdk" class="table-of-contents__link toc-highlight">6. Initialization of the SDK</a></li><li><a href="#7-transaction-flow" class="table-of-contents__link toc-highlight">7. Transaction Flow</a></li><li><a href="#8-sdk-async-behaviour-after-starttransaction-returns" class="table-of-contents__link toc-highlight">8. SDK Async Behaviour after startTransaction Returns</a></li><li><a href="#9-conclusion" class="table-of-contents__link toc-highlight">9. Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://halodot.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Halodot.io<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.synthesis.co.za/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Synthesis<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/halo-dot/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/halo-dot/test_app-android_sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Halodot.io.</div></div></div></footer></div>
</body>
</html>